<div
  class="ide-container"
  [class.light-theme]="!theme.isDark()"
  [class.sidebar-hidden]="!nav.isSidebarVisible()"
  [class.preview-focused]="nav.viewMode() === 'preview'"
  [class.has-auth]="auth.currentUser()"
>
  <!-- Title Bar -->
  <header class="title-bar">
    <div class="menu-items">
      <div class="mobile-menu-toggle" (click)="nav.toggleSidebar()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 12h18M3 6h18M3 18h18" />
        </svg>
      </div>
      <img
        src="https://upload.wikimedia.org/wikipedia/commons/9/9a/Visual_Studio_Code_1.35_icon.svg"
        alt="logo"
        class="vscode-logo"
      />
      <span class="desktop-only">File</span>
      <span class="desktop-only">Edit</span>
      <span class="desktop-only">Selection</span>
      <span class="desktop-only">View</span>
      <span class="desktop-only">Go</span>
      <span class="desktop-only">Run</span>
      <span class="desktop-only">Terminal</span>
      <span class="desktop-only">Help</span>
    </div>
    <div class="app-title">{{ nav.activeFile()?.name || 'Portfolio' }} - Visual Studio Code</div>
    <div class="window-controls">
      <div class="theme-toggle" (click)="theme.toggleTheme()">
        @if (theme.isDark()) {
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="5" />
          <path
            d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"
          />
        </svg>
        } @else {
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
        </svg>
        }
      </div>
      <span class="control-btn minimize">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M5 12h14" />
        </svg>
      </span>
      <span class="control-btn maximize">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="6" y="6" width="12" height="12" rx="1" />
        </svg>
      </span>
      <span class="control-btn close">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6 6 18M6 6l12 12" />
        </svg>
      </span>
    </div>
  </header>

  <div class="main-body">
    <!-- Activity Bar -->
    <aside class="activity-bar">
      <div class="action-top">
        <div
          class="action-item"
          [class.active]="nav.isSidebarVisible()"
          (click)="nav.toggleSidebar()"
        >
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" />
            <path d="M9 3v18" />
          </svg>
        </div>
        <div class="action-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8" />
            <path d="m21 21-4.3-4.3" />
          </svg>
        </div>
        <div class="action-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path
              d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"
            />
            <path d="M9 18c-4.51 2-5-2-7-2" />
          </svg>
        </div>
      </div>
      <div class="action-bottom">
        <div class="action-item" (click)="modal.open('login')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
            <circle cx="12" cy="7" r="4" />
          </svg>
        </div>
        @if (auth.currentUser()) {
        <div class="action-item" (click)="auth.logout()" title="Logout">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
            <polyline points="16 17 21 12 16 7" />
            <line x1="21" y1="12" x2="9" y2="12" />
          </svg>
        </div>
        }
        <div class="action-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3" />
            <path
              d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"
            />
          </svg>
        </div>
      </div>
    </aside>

    <!-- Sidebar Explorer -->
    <app-sidebar></app-sidebar>

    <!-- Workspace Area -->
    <div class="workspace-area">
      <!-- Left: Code & Terminal -->
      <div class="code-zone">
        <section class="editor-shell">
          <app-tabs-bar></app-tabs-bar>
          @if (nav.activeFile(); as file) {
          <div class="breadcrumb">
            <span>portfolio</span> > <span>{{ file.name }}</span>
          </div>
          }
          <main class="editor-content">
            <router-outlet></router-outlet>
          </main>
        </section>

        <section class="terminal desktop-only">
          <div class="terminal-tabs">
            <div class="terminal-tab active">TERMINAL</div>
            <div class="terminal-tab">OUTPUT</div>
            <div class="terminal-tab">DEBUG CONSOLE</div>
          </div>
          <div class="terminal-content" #terminalScroll>
            @for (log of terminal.logs(); track $index) {
            <div class="terminal-line">
              @if (log.type === 'info') { <span class="info">[INFO]</span> } @else if (log.type ===
              'success') { <span class="success">âœ“</span> }
              {{ log.message }}
            </div>
            }
            <div class="terminal-line animated-cursor">
              Build successful. Watching for changes...
            </div>
          </div>
        </section>
      </div>

      <!-- Right: Preview Area with VS Code Tab and Chrome Frame -->
      <section class="preview-shell">
        <!-- VS Code-like Tab Header for Preview -->
        <header class="preview-tabs-bar">
          <div
            class="tab"
            [class.active]="nav.viewMode() === 'preview'"
            (click)="nav.viewMode.set('preview')"
          >
            <svg
              class="preview-icon"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="10" />
              <circle cx="12" cy="12" r="4" />
              <line x1="12" y1="2" x2="12" y2="4" />
              <line x1="12" y1="20" x2="12" y2="22" />
              <line x1="2" y1="12" x2="4" y2="12" />
              <line x1="20" y1="12" x2="22" y2="12" />
            </svg>
            <span>Live Preview</span>
          </div>

          <div
            class="tab mobile-only"
            [class.active]="nav.viewMode() === 'code'"
            (click)="nav.viewMode.set('code')"
          >
            <span class="file-icon-placeholder">{{ '{' }}{{ '}' }}</span>
            <span>{{ nav.activeFile()?.name || 'Code' }}</span>
          </div>
        </header>

        <div class="preview-workspace">
          <!-- Chrome-style Browser Frame -->
          <div class="chrome-browser">
            <header class="chrome-header">
              <!-- Chrome Tabs Row -->
              <div class="chrome-tabs">
                <div class="chrome-tab active">
                  <img
                    src="https://raw.githubusercontent.com/PKief/vscode-material-icon-theme/master/icons/angular.svg"
                    alt=""
                    class="chrome-favicon"
                  />
                  <span class="tab-title">Portfolio</span>
                  <svg
                    class="chrome-close"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M18 6 6 18M6 6l12 12" />
                  </svg>
                </div>
                <div class="chrome-add-tab">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 5v14M5 12h14" />
                  </svg>
                </div>
              </div>
              <!-- Chrome Address Bar Row -->
              <nav class="chrome-nav">
                <div class="nav-btns">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="m15 18-6-6 6-6" />
                  </svg>
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2.5"
                    style="opacity: 0.3"
                  >
                    <path d="m9 18 6-6-6-6" />
                  </svg>
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path
                      d="M21 2v6h-6M3 12a9 9 0 0 1 15-6.7L21 8M3 22v-6h6M21 12a9 9 0 0 1-15 6.7L3 16"
                    />
                  </svg>
                </div>
                <div class="address-bar">
                  <div class="address-info">
                    <svg
                      class="lock"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                      <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                    </svg>
                    <span>localhost:4200/{{ nav.activeFile()?.path || '' }}</span>
                  </div>
                  <div class="address-actions">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="m19 21-4.3-4.3" />
                      <circle cx="11" cy="11" r="8" />
                    </svg>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path
                        d="m12 2 3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
                      />
                    </svg>
                  </div>
                </div>
                <div class="chrome-utils">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
                  </svg>
                  <div class="user-avatar">F</div>
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="1" />
                    <circle cx="12" cy="5" r="1" />
                    <circle cx="12" cy="19" r="1" />
                  </svg>
                </div>
              </nav>
            </header>
            <main class="browser-body">
              <!-- Navigation Arrows -->
              @if (nav.getSectionIndex() > 0) {
              <button class="nav-arrow prev" (click)="nav.prevSection()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                  <path d="m15 18-6-6 6-6" />
                </svg>
              </button>
              } @if (nav.getSectionIndex() < nav.getTotalSections() - 1) {
              <button class="nav-arrow next" (click)="nav.nextSection()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                  <path d="m9 18 6-6-6-6" />
                </svg>
              </button>
              }

              <!-- Horizontal Slider Container -->
              <div
                class="preview-slider"
                [style.transform]="'translateX(-' + nav.getSectionIndex() * 100 + '%)'"
              >
                <div id="about-section" class="preview-section-wrapper">
                  @if (auth.currentUser()) {
                  <button class="edit-overlay-btn" (click)="modal.open('edit-profile')">
                    Edit Profile
                  </button>
                  }
                  <app-about-preview></app-about-preview>
                </div>

                <div id="skills-section" class="preview-section-wrapper">
                  @if (auth.currentUser()) {
                  <button class="edit-overlay-btn" (click)="modal.open('edit-skills')">
                    Edit Skills
                  </button>
                  }
                  <app-skills-preview></app-skills-preview>
                </div>

                <div id="projects-section" class="preview-section-wrapper">
                  @if (auth.currentUser()) {
                  <button class="edit-overlay-btn" (click)="modal.open('edit-projects')">
                    Edit Projects
                  </button>
                  }
                  <app-projects-preview></app-projects-preview>
                </div>

                <div id="contact-section" class="preview-section-wrapper">
                  @if (auth.currentUser()) {
                  <button class="edit-overlay-btn" (click)="modal.open('edit-contact')">
                    Edit Contact
                  </button>
                  }
                  <app-contact-preview></app-contact-preview>
                </div>
              </div>
            </main>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- Status Bar -->
  <footer class="status-bar">
    <div class="status-left">
      <div class="status-item">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="m7 15 5 5 5-5" />
          <path d="m7 9 5-5 5 5" />
        </svg>
        <span>main*</span>
      </div>
      <div class="status-item">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10" />
          <path d="m15 9-6 6" />
          <path d="m9 9 6 6" />
        </svg>
        <span>0</span>
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z" />
          <path d="M12 9v4" />
          <path d="M12 17h.01" />
        </svg>
        <span>0</span>
      </div>
    </div>
    <div class="status-right">
      <div class="status-item">Ln 1, Col 1</div>
      <div class="status-item">Spaces: 2</div>
      <div class="status-item">UTF-8</div>
      <div class="status-item">{{ nav.activeFile()?.type?.toUpperCase() || 'TEXT' }}</div>
    </div>
  </footer>

  <app-modal-container></app-modal-container>
</div>
